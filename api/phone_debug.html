<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ShuoAPI Debug</title>
<script defer src="https://shuoweb.com/common.js"></script>
    <link rel="stylesheet" href="https://shuoweb.com/css/href.css">
<style>
body{
    background:#020617;
    color:#e2e8f0;
    font-family:monospace;
    padding:20px;
}
.card{
    background:#0f172a;
    padding:20px;
    border-radius:12px;
    max-width:700px;
    margin:auto;
}
h1{color:#38bdf8;text-align:center}
.row{
    padding:10px;
    margin:8px 0;
    border-radius:8px;
    background:#020617;
}
.ok{color:#22c55e}
.warn{color:#facc15}
.err{color:#ef4444}
pre{
    background:#000;
    padding:10px;
    overflow:auto;
    border-radius:8px;
}
</style>
</head>

<body>

<div class="card">

<h1>ğŸ” ShuoAPI è‡ªåŠ¨è¯Šæ–­</h1>

<div id="env" class="row">æ£€æµ‹ç¯å¢ƒ...</div>
<div id="https" class="row">æ£€æµ‹ HTTPS...</div>
<div id="api" class="row">æ£€æµ‹ API...</div>
<div id="json" class="row">æ£€æµ‹ JSON...</div>
<div id="latency" class="row">æµ‹é€Ÿä¸­...</div>

<h3>è¿”å›å†…å®¹ï¼š</h3>
<pre id="output">ç­‰å¾…è¯·æ±‚...</pre>

</div>

<script>

const API="https://shuo-api.xo.je/phone/";

function set(id,msg,cls){
    const el=document.getElementById(id);
    el.innerHTML=msg;
    el.className="row "+cls;
}

// ===== ç¯å¢ƒæ£€æµ‹ =====
if(location.protocol==="file:"){
    set("env","âš ï¸ å½“å‰æ˜¯ file:// æ‰“å¼€ï¼ˆå¼ºçƒˆå»ºè®®ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨ï¼‰","warn");
}else{
    set("env","âœ… HTTP ç¯å¢ƒæ­£å¸¸ï¼š"+location.protocol,"ok");
}

// HTTPS æ£€æµ‹
if(location.protocol==="https:" || location.hostname==="localhost"){
    set("https","âœ… HTTPS ç¯å¢ƒå®‰å…¨","ok");
}else{
    set("https","âš ï¸ é HTTPSï¼Œå¯èƒ½è¢«æµè§ˆå™¨é™åˆ¶","warn");
}

// ===== API æ£€æµ‹ =====
(async()=>{

try{

    const start=performance.now();

    const res=await fetch(API,{cache:"no-store"});

    const latency=Math.round(performance.now()-start);

    set("api","âœ… API å¯è®¿é—® (HTTP "+res.status+")","ok");
    set("latency","â± å»¶è¿Ÿï¼š"+latency+" ms",
        latency<800?"ok":
        latency<2000?"warn":"err"
    );

    const text=await res.text();
    document.getElementById("output").textContent=text;

    try{
        JSON.parse(text);
        set("json","âœ… è¿”å› JSON æ ¼å¼æ­£ç¡®","ok");
    }catch{
        set("json","âŒ è¿”å›ä¸æ˜¯åˆæ³• JSON","err");
    }

}catch(e){

    console.error(e);

    set("api","âŒ Fetch å¤±è´¥ï¼š"+e.message,"err");
    set("json","æ— æ³•æ£€æµ‹ JSON","err");
    set("latency","æµ‹é€Ÿå¤±è´¥","err");

}

})();

</script>

</body>
</html>